<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="API Composition vs CQRS Pattern"><meta name="keywords" content="msa,cqrs,api,composition,API_Composition"><meta name="author" content="Sungbin Hong"><meta name="copyright" content="Sungbin Hong"><title>API Composition vs CQRS Pattern | devk0ng's blog</title><link rel="shortcut icon" href="/img/icon2.png"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="canonical" href="https://devk0ng.github.io/2021/07/27/api_composition_and_cqrs/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-3745226285485669',
  enable_page_level_ads: 'true'
});
</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"LK74G203SS","apiKey":"82b60d701a0005a22c7f6e2476b74ac1","indexName":"myblog","hits":{"per_page":10},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="devk0ng's blog" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#API-Composition%EA%B3%BC-CQRS-%EB%93%B1%EC%9E%A5%EB%B0%B0%EA%B2%BD"><span class="toc-number">1.</span> <span class="toc-text">API Composition과 CQRS 등장배경</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#API-Composition"><span class="toc-number">2.</span> <span class="toc-text">API Composition</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CQRS"><span class="toc-number">3.</span> <span class="toc-text">CQRS</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/icon2.png"></div><div class="author-info__name text-center">Sungbin Hong</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">40</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">37</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">15</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/background2.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">devk0ng's blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">API Composition vs CQRS Pattern</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-07-27</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/msa/">msa</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="API-Composition과-CQRS-등장배경"><a href="#API-Composition과-CQRS-등장배경" class="headerlink" title="API Composition과 CQRS 등장배경"></a>API Composition과 CQRS 등장배경</h1><p>마이크로서비스로 전체 구성을 하였다고 가정을 해보자!<br>특정 서비스를 제공하는 녀석을 A라고 가정해본닷. 그리고 A로 전달된 클라이언트의 request를 처리하기 위해서는 A친구는 다른 마이크로서비스 B,C,D에서 제공하는 정보를 조합해서 클라이언트에게 최종적인 결과를 주어야한닷</p>
<p>이때, 이 상황에서 사용할 수 있는 방법이 2가지 존재해!!</p>
<p>바로~ API Composition과 CQRS야!!</p>
<span id="more"></span>

<p><br><br><br><br></p>
<h1 id="API-Composition"><a href="#API-Composition" class="headerlink" title="API Composition"></a>API Composition</h1><p>먼저 api composition이라는 놈을 보자!!</p>
<p><img src="https://i.imgur.com/NV9hOyi.png" alt="https://i.imgur.com/NV9hOyi.png"></p>
<p>위 그림이 API Composition의 한 예야. 보다시비 sevice A,B,C가 존재하고 각각의 서비스들로부터의 결과들을 조합,조립 해주는 API composer가 있어!!</p>
<p>이렇게 각각의 결과들을 조립해주는 API composer를 통해 각각의 서비스의 데이터들을 모아 클라이언트에게 제공하는 방식을 API Composition이라고 해!!</p>
<p>이 친구의 장점을 뭘까?? 바로 Simple and Simple and Simple! 이야!! 만약 <strong>조합해야하는 데이터가 많지 않다면</strong> 이 방법을 고려해볼 수 있지!!</p>
<p>B.U.T 여러 서비스들을 호출해서 조합해야하는 경우 위 방법은 좋지 않을 수 있어.</p>
<p>왜냐하면 결과적으로 API Composer가 메모리상에서 각각의 결과들을 조합해야하고 이는 규모가 커지면 부담으로 다가와!! 그리고 각각의 서비스를 호출하는 부분에 있어서 만약 동기방식으로 만들어졌다면 Delay가 발생할수도 있을거구 각각의 서비스들로 보낸 요청이 잘왔는지 혹은 따로 검사해봐야할 조건들을 처리하는 로직들이 추가되어질텐데 이러한 부분도 규모가 커지면 우리 composer 친구가 부담이 되어지지!!</p>
<p>그래서 그 다음 방법을 생각해낸거쥐 😮</p>
<p><br><br><br><br></p>
<h1 id="CQRS"><a href="#CQRS" class="headerlink" title="CQRS"></a>CQRS</h1><p><img src="https://i.imgur.com/ZI1mODa.png" alt="https://i.imgur.com/ZI1mODa.png"></p>
<p>CQRS에 대해서는 따로 정리를 하기도 했었으니 간단하게 스슥하고 넘어가겠습니다!!</p>
<p>CUD 즉 시스템의 정보를 변경하는 작업들이 발생하면 해당 정보를 포함한 Event를 발행시키고 Query를 담당하는 쪽에서 해당 Event를 구독하고 있기에 이를 받게 될 때 변경된 데이터에 대한 동기화 작업을 Query용 Database에 하는거야!!</p>
<p>이렇게 될 경우 그 전 API Composition에서 발생하는 문제점들을 해결할 수 있어!!</p>
<p>B.U.T 위 그림에서도 느낌이 오지만 확실히 API Composition방법에 비해서는 더 Complex하다는 단점이 존재해.</p>
<p>그때그때 상황에 맞추어 더 효율적인 방안을 택하면 될 거 같다 이말이야!!</p>
<p><br><br><br><br><br><br><br></p>
<blockquote>
<p>출처 : <a target="_blank" rel="external nofollow noopener noreferrer" href="https://learn.co/lessons/microservices-patterns-chapter-7">https://learn.co/lessons/microservices-patterns-chapter-7</a></p>
</blockquote>
</div></article><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/msa/">msa</a><a class="post-meta__tags" href="/tags/cqrs/">cqrs</a><a class="post-meta__tags" href="/tags/api/">api</a><a class="post-meta__tags" href="/tags/composition/">composition</a><a class="post-meta__tags" href="/tags/API-Composition/">API_Composition</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/07/27/polymorphism_and_solid_and_spring/"><i class="fa fa-chevron-left">  </i><span>다형성과 SOLID, 그리고 Spring</span></a></div><div class="next-post pull-right"><a href="/2021/07/27/cqrs/"><span>CQRS 패턴이란?</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: 'a9fadaa0c71177598341',
  clientSecret: '677df1a9ceea07288fecd99348d15054f5659172',
  repo: 'devk0ng.github.io',
  owner: 'devk0ng',
  admin: 'devk0ng',
  id: md5(decodeURI(location.pathname)),
  language: 'en'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(/img/background2.png)"><div class="layout" id="footer"><div class="copyright">&copy;2021 - 2022 By Sungbin Hong</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="external nofollow noopener noreferrer" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script src="/js/search/algolia.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>